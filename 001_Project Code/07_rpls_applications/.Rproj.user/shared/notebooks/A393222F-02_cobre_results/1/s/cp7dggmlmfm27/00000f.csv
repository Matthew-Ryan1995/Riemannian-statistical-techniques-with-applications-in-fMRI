"0","get_coeff_plot <- function(name){"
"0","  if(name == ""age""){"
"0","    C <- unvec(P = M$muX, vec = B[, 1])"
"0","  }else{"
"0","    C <- unvec(P = M$muX, vec = B[, 2])"
"0","  }"
"0","  dat <- C %>% "
"0","    as_tibble(rownames = ""source"") %>% "
"0","    mutate(source = fct_inorder(source),"
"0","           source = fct_rev(source)) %>% "
"0","    pivot_longer(-source, names_to = ""target"") %>% "
"0","    mutate(target = factor(target, levels = levels(source)),"
"0","           target = fct_rev(target),"
"0","           value = ifelse(abs(value) < quantile(abs(value), 0.9), 0, value))"
"0","  "
"0","  p <- dat %>% "
"0","    ggplot(aes(x = target, y = source, colour = value)) +"
"0","    geom_point(size = 2) +"
"0","    scale_x_discrete(position = ""top"") +"
"0","    scale_colour_distiller(palette = ""RdBu"", direction = 1)+"
"0","    labs(x = NULL, y = NULL, colour = NULL) +"
"0","    ggtitle(str_c(name)) +"
"0","    theme_minimal() +"
"0","    theme(axis.text.x = element_text(angle = 90),"
"0","          plot.title = element_text(hjust = 0.5))"
"0","  "
"0","  return(p)"
"0","}"
