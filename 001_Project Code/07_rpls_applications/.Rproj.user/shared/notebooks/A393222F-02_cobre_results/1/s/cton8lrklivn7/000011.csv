"0","get_loading_plot <- function(L){"
"0","  C <- unvec(P = M$muX, vec = M$loadingsX[[L]])"
"0","  y_lod <- M$loadingsY[[L]]"
"0","  "
"0","  dat <- C %>% "
"0","    as_tibble(rownames = ""source"") %>% "
"0","    mutate(source = fct_inorder(source),"
"0","           source = fct_rev(source)) %>% "
"0","    pivot_longer(-source, names_to = ""target"") %>% "
"0","    mutate(target = factor(target, levels = levels(source)),"
"0","           target = fct_rev(target),"
"0","           value = ifelse(abs(value) < quantile(abs(value), 0.9), 0, value))"
"0","  "
"0","  "
"0","  p <- dat %>% "
"0","    ggplot(aes(x = target, y = source, colour = value)) +"
"0","    geom_point(size = 2) +"
"0","    scale_x_discrete(position = ""top"") +"
"0","    scale_colour_distiller(palette = ""RdBu"", direction = 1)+"
"0","    labs(x = NULL, y = NULL, colour = NULL) +"
"0","    ggtitle(str_c(""Y loadings\n age = "", round(y_lod[1,1], 3),"
"0","                  "" | group = "", round(y_lod[2,1], 3))) +"
"0","    theme_minimal() +"
"0","    theme(axis.text.x = element_text(angle = 90),"
"0","          plot.title = element_text(hjust = 0.5))"
"0","  return(p)"
"0","}"
