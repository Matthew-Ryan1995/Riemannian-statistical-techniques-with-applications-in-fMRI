"0","return_best_mod <- function(cv, method){"
"0","  tab <- cv %>% "
"0","    filter(K <= 10) %>% "
"0","    select(K, r2 = r2_1, rmse:spec) %>% "
"0","    group_by(K) %>% "
"0","    summarise(mean_r2 = mean(r2),"
"0","              mean_rmse = mean(rmse),"
"0","              sd_r2 = sd(r2),"
"0","              sd_rmse = sd(rmse),"
"0","              mean_acc = mean(accuracy),"
"0","              mean_sens = mean(sens),"
"0","              mean_spec = mean(spec),"
"0","              sd_acc = sd(accuracy),"
"0","              sd_sens = sd(sens),"
"0","              sd_spec = sd(spec)) %>% "
"0","    mutate("
"0","      across(contains(""sd""), ~.x/sqrt(10))"
"0","    )"
"0","  "
"0","  optimal_k <- find_within_1_se(tab)"
"0","  "
"0","  res <- tab %>% "
"0","    mutate("
"0","      r2 = str_c(round(mean_r2, mean_round), "" ("", round(sd_r2, se_round), "")""),"
"0","      rmse = str_c(round(mean_rmse, mean_round), "" ("", round(sd_rmse, se_round), "")""),"
"0","      accuracy = str_c(round(mean_acc, mean_round), "" ("", round(sd_acc, se_round), "")""),"
"0","      sens = str_c(round(mean_sens, mean_round), "" ("", round(sd_sens, se_round), "")""),"
"0","      spec = str_c(round(mean_spec, mean_round), "" ("", round(sd_spec, se_round), "")""),"
"0","    ) %>% "
"0","    select(K, r2:spec) %>%"
"0","    ungroup() %>% "
"0","    filter(K == optimal_k) %>% "
"0","    mutate(method = method) %>% "
"0","    select(method, everything())"
"0","  return(res)"
"0","}"
