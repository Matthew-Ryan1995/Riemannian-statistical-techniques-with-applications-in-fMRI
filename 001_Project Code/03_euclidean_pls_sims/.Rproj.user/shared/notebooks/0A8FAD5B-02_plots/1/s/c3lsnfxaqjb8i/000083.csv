"0","df %>% "
"0","  filter(n == 150) %>% "
"0","  group_by(sig, n, K, p, q) %>% "
"0","  summarise(across(c(contains(""rmse""), contains(""r2"")), mean), .groups = ""drop"") %>% "
"0","  mutate(sig = as.factor(sig)) %>% "
"0","  rename(r2 = ""P_r2"") %>% "
"0","  ggplot(aes(x = K, y = r2)) +"
"0","  geom_line(aes(colour = sig)) +"
"0","  geom_point(data = max_possible_r2, shape = 4, colour = ""black"", size = 2) +"
"0","  geom_vline(xintercept = 5, colour = ""red"", lty = 2) +"
"0","  facet_grid(p ~ q, labeller = label_both) +"
"0","  harrypotter::scale_color_hp_d(""ravenclaw"") +"
"0","  scale_x_continuous(labels = 1:10, breaks = 1:10) +"
"0","  scale_y_continuous(limits = c(0, 1)) +"
"0","  labs(x = ""Number of PLS components"","
"0","       y = latex2exp::TeX(""$R^2$""),"
"0","       colour = ""Error"") +"
"0","  theme_classic() +"
"0","  theme(panel.spacing = unit(2, ""lines""), "
"0","        # strip.text = element_text(size = 10),"
"0","        strip.background = element_rect(fill = ""gray70""))"
