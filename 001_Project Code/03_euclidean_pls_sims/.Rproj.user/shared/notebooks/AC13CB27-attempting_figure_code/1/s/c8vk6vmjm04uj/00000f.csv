"0","x_dim <- 15"
"0","y_dim <- 15"
"0","sigma <- 0"
"0","N <- 150"
"0","tmp_df <- df %>% "
"0","  filter(sig == sigma, "
"0","         p == choose(x_dim + 1, 2), "
"0","         q == choose(y_dim + 1, 2),"
"0","         n == N"
"0","  )"
"0",""
"0","y_int <- expand_grid("
"0","  val = c(0.2, 0.4, 0.6, 0.8, 1),"
"0","  metric = factor(c(""P: R2"", ""Q: R2"", ""X: R2"", ""Y: R2"","
"0","                    ""X: RMSE"", ""Y: RMSE""),"
"0","                  levels = c(""P: R2"", ""Q: R2"", ""X: R2"", ""Y: R2"","
"0","                             ""X: RMSE"", ""Y: RMSE""))"
"0",") %>% "
"0","  filter(!(metric %in% c(""X: RMSE"", ""Y: RMSE"")))"
"0",""
"0","tmp_df %>% "
"0","  pivot_longer(-(sig:L), names_to = ""metric"") %>% "
"0","  mutate(metric = case_when("
"0","    str_detect(metric, ""P"") ~ ""P: R2"","
"0","    str_detect(metric, ""Q"") ~ ""Q: R2"","
"0","    str_detect(metric, ""X_r2"") ~ ""X: R2"","
"0","    str_detect(metric, ""Y_r2"") ~ ""Y: R2"","
"0","    str_detect(metric, ""X_rmse"") ~ ""X: RMSE"","
"0","    str_detect(metric, ""Y_rmse"") ~ ""Y: RMSE"""
"0","  ),"
"0","  metric = factor(metric,"
"0","                  levels = c(""P: R2"", ""Q: R2"", ""X: R2"", ""Y: R2"","
"0","                             ""X: RMSE"", ""Y: RMSE"")),"
"0","  K = as.factor(K),"
"0","  n = as.factor(n)"
"0","  ) %>% "
"0","  group_by(metric, n, K) %>% "
"0","  summarise("
"0","    median = median(value),"
"0","    Q1 = quantile(value, 1/4),"
"0","    Q3 = quantile(value, 3/4),"
"0","    .groups = ""drop"""
"0","  ) %>% "
"0","  filter(!(metric %in% c(""X: RMSE"", ""Y: RMSE""))) %>% "
"0","  mutate("
"0","    gp2 = ifelse(str_detect(metric, ""P|Q""),"
"0","                 ""Loading"","
"0","                 ""Data""),"
"0","    gp = ifelse(str_detect(metric, ""P|X""), "
"0","                ""Predictor"", "
"0","                ""Response""),"
"0","    label = case_when("
"0","      str_detect(metric, ""P"") ~ ""P"","
"0","      str_detect(metric, ""Q"") ~ ""Q"","
"0","      str_detect(metric, ""X"") ~ ""X"","
"0","      str_detect(metric, ""Y"") ~ ""Y"","
"0","    ),"
"0","    gp = as.factor(gp)) %>% "
"0","  ggplot(aes(x = K, y = median, "
"0","             colour = gp, "
"0","             group = metric,"
"0","             shape = gp2,"
"0","             label = label"
"0","  )) +"
"0","  geom_hline(data = y_int, "
"0","             aes(yintercept = val),"
"0","             lty = 2, colour = ""gray90"") +"
"0","  geom_linerange(aes(ymin = Q1, ymax = Q3), "
"0","                 position = position_dodge(width = 0.5),"
"0","                 # lty = 2,"
"0","                 # alpha = 0.5"
"0","  ) +"
"0","  geom_point(position = position_dodge(width = 0.5)) +"
"0","  # geom_text(position = position_dodge(width = 0.5)) +"
"0","  # facet_wrap(~metric, scale = ""free_y"") +"
"0","  harrypotter::scale_color_hp_d(""ravenclaw"") +"
"0","  labs(y = NULL, "
"0","       colour = NULL,"
"0","       shape = NULL,"
"0","       title = str_c(""Euclidean PLS\n"", "
"0","                     ""p = "", choose(x_dim + 1 , 2),"
"0","                     ""; q = "", choose(y_dim + 1, 2),"
"0","                     ""; sigma = "", sigma"
"0","       )) +"
"0","  theme_classic() +"
"0","  theme(legend.position = ""bottom"","
"0","        text = element_text(size = 14),"
"0","        strip.text = element_text(size = 20),"
"0","        strip.background = element_rect(fill = ""gray70""),"
"0","        plot.title = element_text(hjust = 0.5)) "
