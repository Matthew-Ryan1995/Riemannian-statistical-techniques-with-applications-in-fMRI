"0","plot_df <- df %>%"
"0","    filter(p == 55, q == 55, sig == 0.05) %>%"
"0","    select(K, n, vars = all_of(""TP_rmse"")) %>%"
"0","    group_by(K, n) %>%"
"0","    summarise(median = median(vars),"
"0","              Q1 = quantile(vars, 1/4),"
"0","              Q3 = quantile(vars, 3/4),"
"0","              .groups = ""drop"")"
"0",""
"0","  # y_label <- case_when("
"0","  #   str_detect(var, ""P_r2"") ~ ""$R^2_S$ (P)"","
"0","  #   str_detect(var, ""Q_r2"") ~ ""$R^2_S$ (Q)"","
"0","  #   str_detect(var, ""X_r2"") ~ ""$R^2$ (X)"","
"0","  #   str_detect(var, ""Y_r2"") ~ ""$R^2$ (Y)"","
"0","  #   str_detect(var, ""X_rmse"") ~ ""RMSE (X)"","
"0","  #   str_detect(var, ""Y_rmse"") ~ ""RMSE (Y)"","
"0","  #   str_detect(var, ""TP_rmse"") ~ ""RMSE (TP)"","
"0","  #   str_detect(var, ""UQ_rmse"") ~ ""RMSE (UQ)"""
"0","  # ) %>%"
"0","  #   latex2exp::TeX()"
"0",""
"0","  if(str_detect(""TP_rmse"", ""r2"")){"
"0","    y_int <- tibble(val = c(0.2, 0.4, 0.6, 0.8, 1))"
"0","    p <- plot_df %>%"
"0","      ggplot(aes(x = K, y = median, col = as.factor(n), shape = as.factor(n))) +"
"0","      geom_hline(data = y_int,"
"0","                 aes(yintercept = val),"
"0","                 lty = 2, colour = ""gray90"") +"
"0","      geom_linerange(aes(ymin = Q1, ymax = Q3), position = position_dodge(width = 0.5),"
"0","                     show.legend = FALSE) +"
"0","      geom_point(size = 3,position = position_dodge(width = 0.5))"
"0","  }else{"
"0","    p <- plot_df %>%"
"0","      ggplot(aes(x = K, y = median, col = as.factor(n), shape = as.factor(n))) +"
"0","      geom_linerange(aes(ymin = Q1, ymax = Q3), position = position_dodge(width = 0.5),"
"0","                     show.legend = FALSE) +"
"0","      geom_point(size = 3,position = position_dodge(width = 0.5))"
"0","  }"
"0",""
"0","  p <- p  +"
"0","    harrypotter::scale_color_hp_d(""ravenclaw"") +"
"0","    theme_classic() +"
"0","    labs(x = ""K"", y = """", colour = ""Sample size:"", shape = ""Sample size:"","
"0","         title = str_c(""Euclidean NIPALS\n"","
"0","                       ""| p = "", unchoose(55),"
"0","                       "" | q = "", unchoose(55),"
"0","                       "" | sigma = "", 0.5, "" |"""
"0","         )) +"
"0","    theme(legend.position = ""bottom"","
"0","          text = element_text(size = 20),"
"0","          plot.title = element_text(hjust = 0.5)) +"
"0","    guides(colour = guide_legend(ncol = 3, byrow = TRUE))"
